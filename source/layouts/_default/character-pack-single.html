<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ .Title }} - Murder Mysteries</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond&family=Cinzel+Decorative:wght@400;700&display=swap" rel="stylesheet">

  <!-- Local CSS -->
  <link rel="stylesheet" href="/css/tailwind.css">
  <style>
    .section {
      margin: 1.5em 0;
      padding: 1em;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    .section-title {
      font-size: 1.3em;
      font-weight: bold;
      margin-bottom: 1em;
      color: #8B4513;
      border-bottom: 2px solid #8B4513;
      padding-bottom: 0.3em;
    }
    .character-list li {
      list-style: none;
      margin: 0.5em 0;
    }
    .introduction {
      font-style: italic;
      font-size: 1.1em;
      background-color: #f0f8ff;
      padding: 1em;
      border-left: 4px solid #4682B4;
      margin: 1em 0;
    }
    .hidden-content {
      background-color: #fff5f5;
      border-left: 4px solid #DC143C;
    }

    .important-warning {
      background-color: #fffbf0;
      border: 2px solid #ff8c00;
      border-radius: 8px;
      padding: 1rem;
      margin: 1.5rem 0;
      text-align: center;
      font-size: 1.1em;
      color: #d2691e;
      box-shadow: 0 2px 4px rgba(255, 140, 0, 0.1);
    }

    .content-with-portrait {
      display: flex;
      gap: 2rem;
      align-items: flex-start;
    }

    .main-content {
      flex: 1;
    }

    .portrait-container {
      flex: 0 0 200px;
      text-align: center;
    }

    .portrait-container img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .portrait-container .caption {
      font-size: 9pt;
      font-style: italic;
      margin-top: 0.5rem;
      color: #666;
    }

    /* Mobile-first responsive styles */
    @media (max-width: 767px) {
      .content-with-portrait {
        flex-direction: column;
      }

      .portrait-container {
        flex: none;
        order: -1;
        margin-bottom: 1rem;
      }

      .portrait-container img {
        max-width: 200px;
      }
    }

    @media (min-width: 768px) {
      .section {
        padding: 1.5em;
      }
      .section-title {
        font-size: 1.5em;
      }
    }

    /* Collapsible section styles */
    .collapsible-section {
      margin: 1.5em 0;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #fff;
    }

    .collapsible-header {
      background-color: #f8f9fa;
      padding: 1em;
      cursor: pointer;
      user-select: none;
      border-radius: 5px 5px 0 0;
      border-bottom: 1px solid #ddd;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s ease;
    }

    .collapsible-header:hover {
      background-color: #e9ecef;
    }

    .collapsible-header h2 {
      margin: 0;
      font-size: 1.3em;
      font-weight: bold;
      color: #8B4513;
    }

    .collapsible-toggle {
      font-size: 1.2em;
      color: #8B4513;
      transition: transform 0.2s ease;
    }

    .collapsible-content {
      padding: 1em;
      display: block;
    }

    .collapsible-content.collapsed {
      display: none;
    }

    .collapsible-header.collapsed .collapsible-toggle {
      transform: rotate(-90deg);
    }

    @media (min-width: 768px) {
      .collapsible-header h2 {
        font-size: 1.5em;
      }
    }

    /* Expand/Collapse All button - styled like back to plotline */
    .expand-all-btn {
      display: inline-block;
      background-color: #f5f5dc;
      color: #333;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 5px;
      cursor: pointer;
      font-size: 10pt;
      font-weight: 600;
      margin-bottom: 1.5rem;
      text-decoration: none;
      transition: background-color 0.2s ease;
    }

    .expand-all-btn:hover {
      background-color: #e5e5e5;
    }
  </style>
</head>
<body class="m-0 p-0 w-screen h-auto min-h-screen font-garamond text-dark md:w-a4 md:h-a4">
  <script>
    function toggleSection(header) {
      const content = header.nextElementSibling;
      const toggle = header.querySelector('.collapsible-toggle');

      if (content.classList.contains('collapsed')) {
        content.classList.remove('collapsed');
        header.classList.remove('collapsed');
        toggle.textContent = '▼';
      } else {
        content.classList.add('collapsed');
        header.classList.add('collapsed');
        toggle.textContent = '▶';
      }

      updateExpandAllButton();
    }

    function toggleAllSections() {
      const button = document.getElementById('expandAllBtn');
      const allContents = document.querySelectorAll('.collapsible-content');
      const allHeaders = document.querySelectorAll('.collapsible-header');
      const allToggles = document.querySelectorAll('.collapsible-toggle');

      const allExpanded = Array.from(allContents).every(content => !content.classList.contains('collapsed'));

      if (allExpanded) {
        // Collapse all
        allContents.forEach(content => content.classList.add('collapsed'));
        allHeaders.forEach(header => header.classList.add('collapsed'));
        allToggles.forEach(toggle => toggle.textContent = '▶');
        button.textContent = 'Expand All';
      } else {
        // Expand all
        allContents.forEach(content => content.classList.remove('collapsed'));
        allHeaders.forEach(header => header.classList.remove('collapsed'));
        allToggles.forEach(toggle => toggle.textContent = '▼');
        button.textContent = 'Collapse All';
      }
    }

    function updateExpandAllButton() {
      const button = document.getElementById('expandAllBtn');
      const allContents = document.querySelectorAll('.collapsible-content');

      if (!button || allContents.length === 0) return;

      const allExpanded = Array.from(allContents).every(content => !content.classList.contains('collapsed'));
      button.textContent = allExpanded ? 'Collapse All' : 'Expand All';
    }

    // Initialize button text on page load
    document.addEventListener('DOMContentLoaded', function() {
      updateExpandAllButton();
    });
  </script>
  <div class="w-full bg-vintage-cream flex items-center justify-center relative p-1rem header-clip mb-0_4cm md:p-2rem">
    <img src="/images/fan_motif.svg" class="absolute w-40mm max-h-35mm left-0 top-1_2 fan-transform-left md:w-fan-sm md:max-h-fan-sm" alt="Left Fan">
    <div>
      <h2 class="font-deco text-11pt text-center m-0_5cm tracking-1pt mt-0">Early Twentieth Century</h2>
      <h1 class="font-cinzel text-26pt leading-27pt max-w-18rem m-0 z-2 text-center font-500"><a href="/" class="no-underline text-dark">Murder Mysteries</a></h1>
    </div>
    <img src="/images/fan_motif.svg" class="absolute w-40mm max-h-35mm right-0 fan-transform-right md:w-fan-sm md:max-h-fan-sm" alt="Right Fan">
  </div>
  <div class="w-full px-1rem md:max-w-content md:px-2cm">
    <!-- Navigation Links -->
    <div class="mb-1_5rem text-center">
      <a href="/locations/whatcom/murder-at-roeder-house/" class="inline-block bg-vintage-cream hover:bg-gray-200 text-dark no-underline px-1rem py-0_5rem rounded-5px text-10pt font-600 transition-colors duration-200">← Back to Plotline</a>
    </div>

    {{ $page := .Params }}
    {{ $characterData := index .Site.Data.locations.whatcom.characters $page.character_key }}
    <h1 class="font-deco text-18pt tracking-0_2rem text-center mb-1rem mt-1rem md:text-24pt md:mb-1_5rem md:mt-2rem">{{ $characterData.archetype }}</h1>

    <p>{{ $characterData.description }}</p>

    <div class="mb-1_5rem text-center">
        <a href="#" id="expandAllBtn" class="inline-block bg-vintage-cream hover:bg-gray-200 text-dark no-underline px-1rem py-0_5rem rounded-5px text-10pt font-600 transition-colors duration-200" onclick="toggleAllSections(); return false;">Expand All</a>
    </div>
    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Historical Inspiration</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">
        {{ $characterData.historical_inspiration | markdownify }}

        {{ if $characterData.resources }}
        <h3>More resources</h3>
        <ul class="pl-12pt text-10pt">
          {{ range $characterData.resources }}
          <li class="mb-2pt">
            {{ if .url }}
              <a href="{{ .url }}" rel="nofollow" class="text-dark hover:underline">{{ if .title }}{{ .title }}{{ else }}{{ .url }}{{ end }}</a>
            {{ else }}
              {{ .title }}
            {{ end }}
            {{ if .note }}<br><em class="text-9pt">{{ .note }}</em>{{ end }}
          </li>
          {{ end }}
        </ul>
        {{ end }}
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header" onclick="toggleSection(this)">
        <h2>ACT 1: Arrival and Introductions</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content">
        <p>Arrive in character, but feel free to ask any questions about the game to the host. Here are some character attributes to help you get into character:</p>
        <ul>
          {{ range $characterData.character_card }}
          <li>{{ .item | markdownify }}</li>
          {{ end }}
        </ul>

        <div class="section-title">Introductions</div>
        <p>During the introductions phase, give this introduction about yourself. Feel free to paraphrase, but don't stray from the core concepts:</p>
        <div class="introduction">"{{ $characterData.introduction }}"</div>

        <div class="section-title">Gossip</div>
        <p>Split into small groups and spread this gossip about the other character that are not in earshot:</p>
        <ul class="list-none p-0">
        {{ range $key, $character := .Site.Data.locations.whatcom.characters }}
          {{ if ne $key $page.character_key }}
          <li class="mt-1rem mb-1rem p-1rem bg-vintage-cream rounded-5px">
            <strong class="no-underline text-black text-12pt font-700"><a href="../{{ $key }}/" class="no-underline text-black hover:underline">{{ $character.archetype }}</a></strong>
            <p class="mt-0_5rem mb-0 text-10pt leading-12pt">{{ $character.gossip }}</p>
          </li>
          {{ end }}
        {{ end }}
        </ul>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Act II: First Clue</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">
        <div class="important-warning"><strong>Important:</strong> Don't read below until Act II starts</div>

        <div class="section-title">Motives</div>

        <p>Ask each person a question about where they were on the night of the murder:</p>

        <ul class="list-none p-0">
        {{ range $key, $character := .Site.Data.locations.whatcom.characters }}
          {{ if isset $characterData.motive_questions $key }}
          <li class="mt-1rem mb-1rem p-1rem bg-vintage-cream rounded-5px">
            <strong class="no-underline text-black text-12pt font-700"><a href="../{{ $key }}/" class="no-underline text-black hover:underline">{{ $character.archetype }}</a></strong>
            <p class="mt-0_5rem mb-0 text-10pt leading-12pt">{{ index $characterData.motive_questions $key }}</p>
          </li>
          {{ end }}
        {{ end }}
        </ul>

        <p>Answers to give:</p>

        <ul class="list-none p-0">
        {{ range $key, $character := .Site.Data.locations.whatcom.characters }}
          {{ if isset $characterData.motive_answers $key }}
          <li class="mt-1rem mb-1rem p-1rem bg-vintage-cream rounded-5px">
            <strong class="no-underline text-black text-12pt font-700"><a href="../{{ $key }}/" class="no-underline text-black hover:underline">{{ $character.archetype }}</a></strong>
            <div class="mt-0_5rem mb-0 text-10pt leading-12pt">
              <p><strong>Innocent: </strong> {{ index (index $characterData.motive_answers $key) "innocent" }}</p>
              <hr />
              <p><strong>Guilty: </strong> {{ index (index $characterData.motive_answers $key) "guilty" }}</p>
            </div>
          </li>
          {{ end }}
        {{ end }}
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Act III: Evidence Found</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">
        <div class="important-warning"><strong>Important:</strong> Don't read below until Act III starts</div>

        <div class="section-title">Alibis</div>

        <p>Questions to ask:</p>

        <ul class="list-none p-0">
        {{ range $key, $character := .Site.Data.locations.whatcom.characters }}
          {{ if isset $characterData.alibi_questions $key }}
          <li class="mt-1rem mb-1rem p-1rem bg-vintage-cream rounded-5px">
            <strong class="no-underline text-black text-12pt font-700"><a href="../{{ $key }}/" class="no-underline text-black hover:underline">{{ $character.archetype }}</a></strong>
            <p class="mt-0_5rem mb-0 text-10pt leading-12pt">{{ index $characterData.alibi_questions $key }}</p>
          </li>
          {{ end }}
        {{ end }}
        </ul>

        <div class="section-title">Answers</div>

        <p>Answers to give:</p>

        <ul class="list-none p-0">
        {{ range $key, $character := .Site.Data.locations.whatcom.characters }}
          {{ if isset $characterData.alibi_answers $key }}
          <li class="mt-1rem mb-1rem p-1rem bg-vintage-cream rounded-5px">
            <strong class="no-underline text-black text-12pt font-700"><a href="../{{ $key }}/" class="no-underline text-black hover:underline">{{ $character.archetype }}</a></strong>
            <div class="mt-0_5rem mb-0 text-10pt leading-12pt">
              <p><strong>Innocent: </strong> {{ index (index $characterData.alibi_answers $key) "innocent" }}</p>
              <hr />
              <p><strong>Guilty: </strong> {{ index (index $characterData.alibi_answers $key) "guilty" }}</p>
            </div>
          </li>
          {{ end }}
        {{ end }}
        </ul>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Act IV: Code Given</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">

        <div class="important-warning"><strong>Important:</strong> Don't read below until Act IV starts</div>

        <div class="section-title">TDB</div>
      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Act V: Discussion</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">
        <div class="important-warning"><strong>Important:</strong> Don't read below until Act V starts</div>

        <div class="section-title">Discussion</div>

        <p>Talk amongst yourselves to try and gather theories. This is unstructured time.</p>

        <div class="section-title">Vote</div>

        <p>Once you have your theory, vote.</p>

      </div>
    </div>

    <div class="collapsible-section">
      <div class="collapsible-header collapsed" onclick="toggleSection(this)">
        <h2>Act VI: The Reveal</h2>
        <span class="collapsible-toggle">▶</span>
      </div>
      <div class="collapsible-content collapsed">
        <div class="important-warning"><strong>Important:</strong> Don't read below until Act VI starts</div>

        <div class="section-title">Statements</div>

        <p>If called upon, give your final statement:</p>

        <p><strong>Innocent: </strong> {{ $characterData.final_statement.innocent }}</p>
        <hr />
        <p><strong>Guilty: </strong> {{ $characterData.final_statement.guilty }}</p>
      </div>
    </div>

  </div>
</body>
</html>